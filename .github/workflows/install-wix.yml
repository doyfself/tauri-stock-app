- name: Install WiX Toolset Manually
  run: |
    # 定义要使用的 WiX 版本和下载链接（以 v3.14.1 为例，您可以根据需要调整）
    $WIX_VERSION = "wix3141rtm"
    $WIX_URL = "https://github.com/wixtoolset/wix3/releases/download/$WIX_VERSION/wix314-binaries.zip"
    $LOCAL_PATH = "$env:LOCALAPPDATA\tauri\WixTools314"

    # 创建目标目录
    New-Item -ItemType Directory -Path $LOCAL_PATH -Force

    # 下载 WiX 二进制文件
    Invoke-WebRequest -Uri $WIX_URL -OutFile "$LOCAL_PATH\wix-binaries.zip"

    # 解压到目标目录
    Expand-Archive -Path "$LOCAL_PATH\wix-binaries.zip" -DestinationPath $LOCAL_PATH -Force

    # 验证 light.exe 是否存在
    if (Test-Path "$LOCAL_PATH\light.exe") {
      Write-Host "WiX Toolset installed successfully."
    } else {
      Write-Error "Failed to install WiX Toolset."
      exit 1
    }
  shell: pwsh